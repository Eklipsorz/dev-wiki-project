---
sidebar_position: 4
---

# API如何適當解決資料的獲取量過大情況

伺服器接收到API請求時，多多少少會從後端獲取資料，當一次要上千、上萬、上百萬的資料給客戶端時，可能會 **因為一次要的資料量過大而導致無法及時達成客戶端所需** 或者 **客戶端收到了卻因為過大而無法及時處理**


可能解法：
1. 透過條件來過濾出想要獲取到的資料，如姓名、郵件地址
2. 使用分頁技術來替大量資料分類，然後讓客戶端決定能看的頁數：根據固定的數量(一頁有幾筆資料，limit)來分類大量資料，假如有十筆資料，而一頁設定存五筆資料，那麼就會有兩頁。

## API定義為搜尋時的URI
1. 以search作為API定義是出自於容易使開發者理解API本身的功能性，雖說以動詞違背RESTful API風格，但終究還是風格，並不是絕對的標準
2. search vs. find：前者意思為在某個地方尋找，後者為尋找特定物品，對於強調某個服務擁有搜尋功能而言，會採用強調哪個地方能夠尋找的search會更為恰當

## 使用分頁技術來替大量資料分類
會使用到SQL中的limit、offset這兩個語法，其中limit會是指定要獲取的資料量會是多少，而offset則是按字面上的意思，當要獲取資料時會跳過offset所指定的量再來獲取資料回應給請求方，在這樣的基礎之下，可以透過limit語法設定每一頁的固定資料量，而offset語法則是藉由其功能性來幫助使用者跳過指定頁數N的資料，來獲取第N+1頁的資料


### 潛在問題
1. 當使用offset或者limit語法時，反應時間會隨著資料量增加而更加緩慢：當使用offset或者limit語法時，資料庫都會從表格下的第一筆紀錄開始找起，若資料過於龐大，那麼指定位置的紀錄就更需要時間來找起
2. 若分頁的資料頻繁發生新增和修改的話，獲取的資料會與預定獲取的資料不一致：當請求端想要最開始的20筆記錄data，當正準備獲取之時，原有紀錄中最前面增加了30筆，總共50筆，這使得獲取之後的20筆記錄不會是data，而是另一種data'



