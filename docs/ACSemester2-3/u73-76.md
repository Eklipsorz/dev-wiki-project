---
sidebar_position: 21
---


# U73-76 技術和新知

## Syntactic Sugar
1. Syntactic 是指與程式語言語法相關的，而Sugar則是比喻透過程式語法來將一個程式模組包裝成一個易讀好維護的語法形式-糖衣。
2. 包裝前和包裝後的功能是一樣，只是差別在於可以讓開發者可以使用更貼近(sweeter)人類的語法：人類可以更好理解、更精準地開發、很好維護的語法
### 參考資料
1. [什么是语法糖？](https://www.zhihu.com/question/20651624)
2. [Syntactic sugar](https://en.wikipedia.org/wiki/Syntactic_sugar)



## model 和 document 在 mongoose中
1. model 和 document 本身是不一樣的物件類別


## todolist 案例下的路由設計
1. 理想下的路由設計：
![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1638262176/blog/srello/idealRouteDesign_a2ttbi.png)

2. 但由於HTML本身對於PUT和Delete的支援性不高，實際上的路由設計會是：
![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1638262176/blog/srello/realRouteDesign_ejwpxb.png)

## todolist 瀏覽所有todo的實作
1. 滿足該瀏覽所有todo的路由會是如下，只要瀏覽根目錄就能即可能瀏覽每個todo
```
GET \
```
2. 實際下MVC架構會是如何做：
  - 這裡客戶端會對著localhost的根目錄來瀏覽網頁，此時客戶端會發送GET / 請求至伺服器，然後由伺服器路由系統來接收GET /請求並轉發至適當的Controller來做後續的處理
  - Controller這邊會需要資料庫的資料來將對應的渲染畫面回傳給客戶端，所以Controller在這裡會先透過Model.find()向Model索要資料庫的某筆資料
  - Model這邊就負責從資料庫獲取指定資料，而資料庫收到請求後就便把資料回傳給Model，接著再由Model轉交給Controller
  - Controller再接著將資料丟向View來麻煩它將資料和模板畫面做一個整合，然後把最後結果的畫面回傳給Controller，而Controller收到View做完合併的結果，就直接把畫面丟給客戶端

![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1638276705/blog/srello/viewAlltodos_mdcimp.png)

3. 在這裡MVC負責以下工作：
  - Controller：負責接收請求、轉接請求、回應請求的工作，本身會含有路由系統來協助滿足這些工作
  ```

  // 載入程式模組，取得對應collection的document constructor
  const todoModel = require('./models/todoModel')
  app.get('/', (req, res) => {

  // 藉由document constructor所擁有的方法-find來對對應的collection建立特定資料搜查的請求(Query)
  //，而由於沒有參數會直接從collection取得所有資料，最後todoModel.find()本身回傳為代表搜查請求Query
  todoModel.find()
  
    .lean()
    .exec()
    .then(todos => res.render('index', { todos }))
    .catch(error => console.log(error))

  })
  ```
  
  - Model： 負責定義資料、管理資料庫中的資料、業務邏輯，在這裡會是定義資料和管理資料庫的資料

  ```
  // 載入mongoose 套件
  const mongoose = require('mongoose')
  
  // 在應用程式層面定義collection的schema
  const Schema = mongoose.Schema
  const todoSchema = new Schema({
  name: {
    type: String, // 資料型別是字串
    required: true // 這是個必填欄位
  }
  })

  // 在指定的資料庫當中建立名為todos的collection，並且回傳以Schema作為內容
  // 儲存限制 之 document constructor，最後以模組內容來輸出，只要有人以目前
  // 所在檔案為模組，該模組內容將會是mongoose.model(....)
  module.exports = mongoose.model('todo', todoSchema)
  ```
