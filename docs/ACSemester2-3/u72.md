---
sidebar_position: 20
---


# U72 技術和新知


## require('express-handlebars')
1. 實際上的模組內容定義匯出內容為如下，require會回傳exphbs函式，而該函式可以不帶參數或者使用config物件一起被調用，exphbs本身會先按照ExpressHandlebars 來建立對應實體(create(config))，接著利用那實體本身的engine屬性來回傳，該屬性值正是主要實現engine功能的 function 或者被稱之為engine factory function，可以直接被被express app 註冊成engine factory function。其中config 物件主要就是express-handlebars設定，開發者可藉由建立該物件並傳入就即可依照config物件內容來呈現

```
const ExpressHandlebars = require("./lib/express-handlebars");

exports = module.exports = exphbs;
// -----------------------------------------------------------------------------

function exphbs (config) {
  return create(config).engine;
}

function create (config) {
  return new ExpressHandlebars(config);
}
```


2. create (config)是用以建立ExpressHandlebars 實體的 factory function，create裡頭的參數會是config物件，ExpressHandlebars 實體會依照config物件內容來建立，而ExpressHandlebars 代表著handlebars本身，而該實體具有可以進一步控制/獲取handlebar的相關設定、執行方式、額外渲染檔案，如engine、compiled、getPartials、getTemplate。



## ExpressHandlebars 的 engine
1. 該engine方法會是綁定於該實體的renderView的function reference，該renderView正是主要實現engine功能的 function 或者被稱之為engine factory function。
```
// Express view engine integration point.
this.engine = this.renderView.bind(this);

async renderView (viewPath, options = {}, callback = null) {
  .
  .
  .
}
```