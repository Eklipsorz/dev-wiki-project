---
sidebar_position: 48
---

# u110 新知和技術 

## 建立使用者登入機制

安裝及設定 Passport

```
npm install passport@0.4.1 passport-local@1.0.0
```

設定 config/passport.js
```
 touch config/passport.js
```



// done 實作對應為如下，其中info為指定的flash message內容，通常會由done去調用req.flash來設定不同種類的訊息，內容會是info，
```
  function verified(err, user, info) {
    if (err) { return self.error(err); }
    if (!user) { return self.fail(info); }
    self.success(user, info);
  }
```
參考資料為
[What is "done" callback function in Passport Strategy Configure "use" function](https://stackoverflow.com/questions/32153865/what-is-done-callback-function-in-passport-strategy-configure-use-function)


在這裏可以改成直接呼叫req.flash(a, b)來建立訊息種類a的陣列來存放內容b
```
done(null, false, req.flash(a, b))

```