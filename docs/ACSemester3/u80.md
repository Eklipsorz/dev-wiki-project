---
sidebar_position: 36
---

# u80 新知和技術 


## 正規化 補充
1. 是架構資料庫表格的標準，並不是在這領域上的唯一解，且市面上大部分皆用到3NF。
2. 主要實現資料表格架構時，得依照業務邏輯、不同使用情景等等因素來實現，可允許違反正規化的標準
3. 實務上，若資料庫存放大量的商業資料，貿然更動資料庫的表格結構會相當違反，甚至可能會有遺失資料的風險。

## 1NF-第一正規化
1. 該正規化主要解決資料冗餘的問題，其格式定義為**在同個資料表格內，每個欄位/屬性的內容都會是不可再分割的原子值(Atomic Value)**，而原子值是強調著內容不可分割，並非指的是現實中的原子。
2. 若資料表格滿足上述定義，就為第一正規化表格
3. 若遇到不滿足於其規格的話，比如同一個表格下的屬性出現複合屬性(Composite attribute)、同一個屬性出現多筆資料，會以下面形式來轉換：
  - 同一個表格下的屬性出現複合屬性(Composite attribute)：由於複合屬性本身由多個屬性組成，所以本身違反著不可再分割這性質，而為了轉換第一正規化格式表格，可以先從複合屬性切割出那些屬性，並刪掉複合屬性名稱就能解決，拿下面表格來說明的話，可將身為複合屬性的地址屬性切割成街道、城市、郵遞區號，然後再刪掉地址這屬性名稱
  ```
  // 變更前：
  識別碼 | 地址 | 電話

  // 變更後
  識別碼 | 街道 | 城市 | 郵遞區號 | 電話
  ```
  - 同一個屬性值出現多筆資料：多筆資料的存在本身就違反著每個欄位/屬性的內容都會是不可再分割的原子值這性質，為了轉換第一正規化格式表格，可以先以每一筆紀錄的每個欄位都只有一個單一值為原則將多餘的紀錄搬移出來變成新的紀錄，若同一個紀錄下的其他屬性是單一值，就在新的紀錄上填上單一值，那下面紀錄來說的話，由於紀錄1的電話有兩筆，所以會建立新的紀錄來存放多餘的電話，其餘屬性值則由於原本就是單一值，所以就直接沿用原值，新的紀錄就為紀錄2
  ```
  // 變更前：
  紀錄1:
    識別碼: 1
    電話: 0912345678, 0912345679
    標題: HI
  // 變更後
  紀錄1:
    識別碼: 1
    電話: 0912345678
    標題: HI
  
  紀錄2:
    識別碼: 1
    電話: 0912345679
    標題: HI
  ```
4. 補充資料：
  - 複合屬性(Composite attribute)：由多個屬性組成的單一屬性，比如地址屬性本身可包含著街道、城市、郵遞區號等屬性值所構成。
  > An attribute composed of many other attribute



## 2NF-第二正規化
1. 該正規化主要解決部分欄位值無法相依於主鍵的問題，其格式定義為**同一個資料表上，在滿足於第一正規化所定義的格式的情況下，所有主鍵以外的欄位都必須與主鍵功能相依**。
2. 功能相依(Functional Dependency，FD)：是資料庫的關係/表格內的兩種屬性集合之間的限制，在一個關係R上的所有紀錄帶有屬性值可依據屬性值是否能夠當作另一個屬性值的識別來分為負責識別另一組屬性值集合B的屬性值集合A、屬性值集合B這兩種集合，而屬性值集合A在本質上是可以代表著另一組屬性值集合B的獨特性，所以兩份紀錄若擁有同一個屬性值集合A，那麼對應的屬性值集合B就會是一樣的，那麼可以說若紀錄上的屬性值集合A屬性出現特定值，就能在屬性值集合A所給予的功能-識別來確定屬性值集合B是什麼，而這些屬性值集合B也依賴著(隨著)屬性值集合A而變化或者依據屬性值集合A的功能-識別來構成一個獨特的對應關係，另外可用A->B來表示兩個集合之間的關係

3. 若當上述的屬性值集合A是主鍵屬性值集合，屬性值集合B是指除了主鍵以外的屬性值集合，這兩者集合之間的關係是A->B，那麼就滿足於**所有主鍵以外的欄位都必須與主鍵功能相依**，此時的表格就會2NF表格


4. 若遇到不滿足於其規格的話，比如表格不為1NF-第一正規化格式、表格內沒有一組功能相依能夠滿足於**所有主鍵以外的欄位都必須與主鍵功能相依**
  - 表格不為1NF-第一正規化格式：解法就是將該表格轉換成第一正規化格式的表格，再來檢查是否滿足第二正規化的定義進行第二點的轉換
  - 表格內沒有一組功能相依能夠滿足於**所有主鍵以外的欄位都必須與主鍵功能相依**：在這情況下，表格內勢必或多或少會有多種兩個屬性值集合之間的功能相依，依照每一種功能相依的屬性值為何來將原表格分割成多個子表格，使每一個表格都帶有不同種類且又是原本功能相依的屬性值，並讓這些功能相依的屬性集合在分割後的表格滿足於**所有主鍵以外的欄位都必須與主鍵功能相依**就能使表格們成為2NF形式表格，比如說若表格內的每筆紀錄屬性集是分別為A、B、C、D且A->C 和 B->D，那麼就將原表格切分成一張只有屬性集合A和屬性集合C的表格X以及一張只有屬性集合B和屬性集合D的表格Y，此時每個表格的主鍵屬性值集合分別會是A和B，而剩餘的屬性值集合會是分別為C和D，所以他們會在各自的表格中滿足於**所有主鍵以外的欄位都必須與主鍵功能相依**



## 3NF-第三正規化
1. 該正規化主要解決**在主鍵屬性集合與剩餘屬性集合之間的功能相依下，藉由移除剩餘屬性集合內部的功能相依來避免相關的不一致問題**，其格式定義為**同一個資料表上，在滿足於第二正規化所定義的格式的情況下，所有主鍵以外的欄位都僅能與主鍵功能相依，且沒有與其它欄位相依**。

2. 若假設一張表保持著2NF且出現著3NF專注解決的問題，而這張表的屬性大致上會分為四類：A、B、C、D，其中功能相依會是A->B、C、D以及C->D，那麼當屬性集合C改變之後，理論上與C有功能相依的D勢必得改變才有滿足於C->D，但在這裏只有集合C改變，所以屬性集合C和屬性集合D之間很有可能會有資料不一致的問題，且若刪除其中一筆紀錄(擁有屬性值A、B、C、D集合的元素)，很有可能因為C->D的關係，而無法透過特定屬性值C來找到對應屬性值D。統整一下問題點，主要會有：
  - 由於C->D是A->B、C、D的情況下產生，所以當C改變時，很容易與原本的D產生不一致
  - 由於C->D是A->B、C、D的情況下產生，只是當紀錄(擁有A、B、C、D)刪除時，很有可能因為C->D的關係，而無法透過特定屬性值C來找到對應屬性值D，比如地址和郵遞區號，若刪了整筆紀錄，很有可能找不到某些地區的郵遞區號
3. 若遇到不滿足於其規格的話，比如表格不為1NF-第二正規化格式、表格內的**非主鍵屬性值集合內部存有功能相依關係**
   - 表格不為1NF-第一正規化格式：解法就是將該表格轉換成第二正規化格式的表格，再來檢查是否滿足第三正規化定義進行第二點的轉換
   - 表格內的**非主鍵屬性值集合內部存有功能相依關係**：以上述來做為例子，假設表格屬性有屬性值集合A、B、C、D這四種集合，而相依狀況會是如下，在這裏只需要將表格切割成屬性值集合A、B、C這三種屬性值集合構成的子表格以及屬性值集合C、D這兩種屬性值集合構成的子表格就能讓這些子表格滿足於3NF，同時也能讓原本主鍵集合A所在表格能夠對應到屬性集合D

   ```
    A->B、C、D
    C->D
   ```


## 正規化參考資料：
[正規化步驟](http://www.tsnien.idv.tw/DataBase_WebBook/chap10/10-5%20正規化步驟.html)